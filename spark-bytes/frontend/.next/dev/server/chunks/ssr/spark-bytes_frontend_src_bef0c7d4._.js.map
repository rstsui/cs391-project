{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ajoha/Downloads/cs391-project/cs391-project/spark-bytes/frontend/src/lib/useAuthGuard.ts"],"sourcesContent":["// src/hooks/useAuthGuard.ts\r\n\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { supabase } from \"@/lib/supabaseClient\";\r\nimport type { User } from \"@supabase/supabase-js\";\r\n\r\ntype UseAuthGuardResult = {\r\n  loading: boolean;\r\n  user: User | null;\r\n};\r\n\r\nexport function useAuthGuard({ redirectToLogin = true } = {}): UseAuthGuardResult {\r\n  const router = useRouter();\r\n  const [loading, setLoading] = useState(true);\r\n  const [user, setUser] = useState<User | null>(null);\r\n\r\n  useEffect(() => {\r\n    async function checkUser() {\r\n      const { data } = await supabase.auth.getUser();\r\n      const usr = data?.user || null;\r\n      setUser(usr);\r\n      setLoading(false);\r\n\r\n      if (!usr && redirectToLogin) {\r\n        router.push(\"/login\");\r\n      }\r\n    }\r\n\r\n    checkUser();\r\n  }, [router, redirectToLogin]);\r\n\r\n  return { loading, user };\r\n}\r\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;;AAG5B;AACA;AACA;AAJA;;;;AAYO,SAAS,aAAa,EAAE,kBAAkB,IAAI,EAAE,GAAG,CAAC,CAAC;IAC1D,MAAM,SAAS,IAAA,6KAAS;IACxB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+OAAQ,EAAC;IACvC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,+OAAQ,EAAc;IAE9C,IAAA,gPAAS,EAAC;QACR,eAAe;YACb,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,sKAAQ,CAAC,IAAI,CAAC,OAAO;YAC5C,MAAM,MAAM,MAAM,QAAQ;YAC1B,QAAQ;YACR,WAAW;YAEX,IAAI,CAAC,OAAO,iBAAiB;gBAC3B,OAAO,IAAI,CAAC;YACd;QACF;QAEA;IACF,GAAG;QAAC;QAAQ;KAAgB;IAE5B,OAAO;QAAE;QAAS;IAAK;AACzB","debugId":null}},
    {"offset": {"line": 44, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ajoha/Downloads/cs391-project/cs391-project/spark-bytes/frontend/src/app/profile_page/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { supabase } from \"@/lib/supabaseClient\";\r\nimport { useAuthGuard } from \"@/lib/useAuthGuard\";\r\n\r\nexport default function ProfilePage() {\r\n  const { loading, user } = useAuthGuard(); // login + redirect to /login if needed\r\n\r\n  const [profile, setProfile] = useState<any>(null);\r\n  const [profileLoading, setProfileLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    async function loadProfile() {\r\n      if (!user) return;\r\n\r\n      setProfileLoading(true);\r\n\r\n      const { data: profileData, error } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"email, role\")\r\n        .eq(\"id\", user.id)\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error(\"Error loading profile:\", error);\r\n        setProfile(null);\r\n      } else {\r\n        setProfile(profileData);\r\n      }\r\n\r\n      setProfileLoading(false);\r\n    }\r\n\r\n    loadProfile();\r\n  }, [user]);\r\n\r\n  // While we're checking auth or fetching the profile\r\n  if (loading || profileLoading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center text-lg\">\r\n        Loading profile…\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // useAuthGuard has already redirected if not logged in\r\n  if (!user || !profile) return null;\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex flex-col bg-gradient-to-b from-white via-teal-50 to-teal-100 px-6 py-16\">\r\n      <div className=\"max-w-xl mx-auto bg-white border border-gray-200 shadow-lg rounded-2xl p-10\">\r\n        {/* HEADER */}\r\n        <h1 className=\"text-2xl font-bold text-center mb-2\">\r\n          {profile.email}\r\n        </h1>\r\n\r\n        <p className=\"text-center text-gray-500 mb-1\">\r\n          Member since {new Date(user.created_at).toLocaleDateString()}\r\n        </p>\r\n\r\n        <div className=\"flex justify-center mt-3\">\r\n          <span\r\n            className={`px-3 py-1 rounded-full text-sm font-medium ${\r\n              profile.role === \"admin\"\r\n                ? \"bg-green-100 text-green-700 border border-green-300\"\r\n                : \"bg-gray-100 text-gray-700 border\"\r\n            }`}\r\n          >\r\n            {profile.role === \"admin\" ? \"Administrator\" : \"Standard User\"}\r\n          </span>\r\n        </div>\r\n\r\n        {/* ABOUT */}\r\n        <div className=\"mt-8 text-center text-gray-700\">\r\n          <p>Welcome to Spark!Bytes — helping reduce food waste across campus.</p>\r\n        </div>\r\n\r\n        {/* ACTION BUTTONS */}\r\n        <div className=\"mt-10 space-y-4\">\r\n          {profile.role === \"admin\" && (\r\n            <a\r\n              href=\"/admin/requests\"\r\n              className=\"block w-full text-center bg-black text-white py-2 rounded-lg hover:bg-gray-900\"\r\n            >\r\n              Admin Dashboard\r\n            </a>\r\n          )}\r\n\r\n          {profile.role !== \"admin\" && (\r\n            <a\r\n              href=\"/request_access\"\r\n              className=\"block w-full text-center bg-teal-600 text-white py-2 rounded-lg hover:bg-teal-700\"\r\n            >\r\n              Request Admin Access\r\n            </a>\r\n          )}\r\n\r\n          <a\r\n            href=\"/profile_reserve\"\r\n            className=\"block w-full text-center bg-gray-100 text-gray-800 py-2 rounded-lg hover:bg-gray-200\"\r\n          >\r\n            View My Events\r\n          </a>\r\n        </div>\r\n      </div>\r\n\r\n      {/* FOOTER */}\r\n      <footer className=\"bg-black text-white text-center text-sm py-6 px-4 mt-20\">\r\n        <p>\r\n          Boston University Center of Computing & Data Sciences: Duan Family\r\n          Spark! Initiative\r\n        </p>\r\n        <p>665 Commonwealth Ave., Boston, MA 02215 | Floor 2, Spark! Space</p>\r\n        <p>buspark@bu.edu</p>\r\n      </footer>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMe,SAAS;IACtB,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,IAAA,wKAAY,KAAI,uCAAuC;IAEjF,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+OAAQ,EAAM;IAC5C,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,+OAAQ,EAAC;IAErD,IAAA,gPAAS,EAAC;QACR,eAAe;YACb,IAAI,CAAC,MAAM;YAEX,kBAAkB;YAElB,MAAM,EAAE,MAAM,WAAW,EAAE,KAAK,EAAE,GAAG,MAAM,sKAAQ,CAChD,IAAI,CAAC,YACL,MAAM,CAAC,eACP,EAAE,CAAC,MAAM,KAAK,EAAE,EAChB,MAAM;YAET,IAAI,OAAO;gBACT,QAAQ,KAAK,CAAC,0BAA0B;gBACxC,WAAW;YACb,OAAO;gBACL,WAAW;YACb;YAEA,kBAAkB;QACpB;QAEA;IACF,GAAG;QAAC;KAAK;IAET,oDAAoD;IACpD,IAAI,WAAW,gBAAgB;QAC7B,qBACE,4QAAC;YAAI,WAAU;sBAAwD;;;;;;IAI3E;IAEA,uDAAuD;IACvD,IAAI,CAAC,QAAQ,CAAC,SAAS,OAAO;IAE9B,qBACE,4QAAC;QAAI,WAAU;;0BACb,4QAAC;gBAAI,WAAU;;kCAEb,4QAAC;wBAAG,WAAU;kCACX,QAAQ,KAAK;;;;;;kCAGhB,4QAAC;wBAAE,WAAU;;4BAAiC;4BAC9B,IAAI,KAAK,KAAK,UAAU,EAAE,kBAAkB;;;;;;;kCAG5D,4QAAC;wBAAI,WAAU;kCACb,cAAA,4QAAC;4BACC,WAAW,CAAC,2CAA2C,EACrD,QAAQ,IAAI,KAAK,UACb,wDACA,oCACJ;sCAED,QAAQ,IAAI,KAAK,UAAU,kBAAkB;;;;;;;;;;;kCAKlD,4QAAC;wBAAI,WAAU;kCACb,cAAA,4QAAC;sCAAE;;;;;;;;;;;kCAIL,4QAAC;wBAAI,WAAU;;4BACZ,QAAQ,IAAI,KAAK,yBAChB,4QAAC;gCACC,MAAK;gCACL,WAAU;0CACX;;;;;;4BAKF,QAAQ,IAAI,KAAK,yBAChB,4QAAC;gCACC,MAAK;gCACL,WAAU;0CACX;;;;;;0CAKH,4QAAC;gCACC,MAAK;gCACL,WAAU;0CACX;;;;;;;;;;;;;;;;;;0BAOL,4QAAC;gBAAO,WAAU;;kCAChB,4QAAC;kCAAE;;;;;;kCAIH,4QAAC;kCAAE;;;;;;kCACH,4QAAC;kCAAE;;;;;;;;;;;;;;;;;;AAIX","debugId":null}}]
}