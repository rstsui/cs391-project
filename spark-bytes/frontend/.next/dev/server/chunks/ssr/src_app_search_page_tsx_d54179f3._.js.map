{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/karachionwuanibe/Desktop/cs~391/projects/cs391-project2/cs391-project/spark-bytes/frontend/src/app/search/page.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { useEffect, useState } from \"react\";\nimport { supabase } from \"@/lib/supabaseClient\";\n\nfunction formatTime(timeString: string) {\n  if (!timeString) return \"\";\n\n  const [hourStr, minuteStr] = timeString.split(\":\");\n  let hour = parseInt(hourStr);\n  const minute = parseInt(minuteStr);\n\n  const ampm = hour >= 12 ? \"PM\" : \"AM\";\n  hour = hour % 12;\n  if (hour === 0) hour = 12; // convert 0 → 12 AM\n\n  return `${hour}:${minute.toString().padStart(2, \"0\")} ${ampm}`;\n}\n\ntype FoodItem = {\n  name: string;\n  quantity: string;\n};\n\ntype EventType = {\n  id: number;\n  title: string;\n  location: string;\n  event_date: string;\n  event_time: string;\n  food_items: FoodItem[];\n  organizer_email: string;\n};\n\nexport default function SearchPage() {\n  const [events, setEvents] = useState<EventType[]>([]);\n  const [filtered, setFiltered] = useState<EventType[]>([]);\n  const [query, setQuery] = useState(\"\");\n\n  // Load events on mount\n  useEffect(() => {\n    async function loadEvents() {\n      const { data, error } = await supabase\n        .from(\"events\")\n        .select(\"*\")\n        .order(\"created_at\", { ascending: false });\n\n      if (error) {\n        console.error(error);\n        return;\n      }\n\n      setEvents(data as EventType[]);\n      setFiltered(data as EventType[]);\n    }\n\n    loadEvents();\n  }, []);\n\n  // Search function\n  const handleSearch = async () => {\n  const lower = query.toLowerCase();\n\n  // Fetch events matching title or location\n  const { data, error } = await supabase\n    .from(\"events\")\n    .select(\"*\")\n    .or(`title.ilike.%${query}%,location.ilike.%${query}%`)\n    .order(\"created_at\", { ascending: false });\n\n  if (error) {\n    console.error(error);\n    return;\n  }\n\n  // Filter food_items and safely check title/location\n  const filteredData = (data || []).filter((event: EventType) => {\n    const titleMatch = event.title?.toLowerCase().includes(lower);\n    const locationMatch = event.location?.toLowerCase().includes(lower);\n    const foodMatch = event.food_items?.some(item =>\n      item.name?.toLowerCase().includes(lower)\n    );\n\n    return titleMatch || locationMatch || foodMatch;\n  });\n\n  setFiltered(filteredData);\n};\n\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-100 via-white to-teal-100 flex flex-col\">\n      {/* Search Section */}\n      <section className=\"flex flex-col items-center justify-center flex-grow px-4\">\n        <h1 className=\"text-3xl font-semibold mb-6 text-center\">\n          Search Spark!Bytes Events\n        </h1>\n\n        {/* Search Bar */}\n        <div className=\"flex w-full max-w-md mb-6\">\n          <input\n            type=\"text\"\n            placeholder=\"Search by name, location...\"\n            value={query}\n            onChange={(e) => setQuery(e.target.value)}\n            className=\"flex-grow border border-gray-300 rounded-l-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500\"\n          />\n          <button\n            onClick={handleSearch}\n            className=\"bg-teal-600 text-white px-4 py-2 rounded-r-lg hover:bg-teal-700\"\n          >\n            Search\n          </button>\n        </div>\n\n        {/* Events Grid */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 w-full max-w-4xl mt-10\">\n          {filtered.length === 0 && (\n            <p className=\"text-gray-600 text-center w-full col-span-full\">\n              No events found.\n            </p>\n          )}\n\n          {filtered.map((event) => (\n            <Link key={event.id} href={`/events/${event.id}`}>\n              <div className=\"bg-white shadow-md border border-gray-300 rounded-xl p-5 cursor-pointer hover:shadow-lg transition\">\n                {/* Title */}\n                <h3 className=\"text-xl font-semibold mb-2\">{event.title}</h3>\n\n                {/* Location */}\n                <p className=\"text-gray-700\">\n                  <strong>Location:</strong> {event.location}\n                </p>\n\n                {/* Date */}\n                <p className=\"text-gray-700\">\n                  <strong>Date:</strong> {event.event_date}\n                </p>\n\n                {/* Time */}\n                <p className=\"text-gray-700\">\n                  <strong>Time:</strong> {formatTime(event.event_time)}\n                </p>\n\n                {/* Food List */}\n                <p className=\"text-gray-700\">\n                  <strong>Food:</strong>\n                </p>\n                <ul className=\"ml-4 list-disc text-gray-700\">\n                  {event.food_items?.map((item, index) => (\n                    <li key={index}>\n                      {item.name} — {item.quantity} left\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            </Link>\n          ))}\n        </div>\n      </section>\n\n      <footer className=\"bg-black text-white text-center text-sm py-6 px-4 mt-auto\">\n        <p>\n          Boston University Center of Computing & Data Sciences: Duan Family Spark! Initiative\n        </p>\n        <p>665 Commonwealth Ave., Boston, MA 02215 | Floor 2, Spark! Space</p>\n        <p>buspark@bu.edu</p>\n      </footer>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}