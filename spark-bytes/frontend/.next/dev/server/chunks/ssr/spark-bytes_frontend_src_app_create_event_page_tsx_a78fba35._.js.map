{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/reneetsui/Desktop/391%20project/cs391-project/spark-bytes/frontend/src/app/create_event/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { supabase } from \"@/lib/supabaseClient\";\n\ntype FoodItem = {\n  name: string;\n  quantity: string;\n};\n\nexport default function CreateEvent() {\n  const router = useRouter();\n\n  const [authorized, setAuthorized] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  const [eventName, setEventName] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [location, setLocation] = useState(\"\");\n  const [date, setDate] = useState(\"\");\n  const [time, setTime] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [capacity, setCapacity] = useState(50);\n\n  const [foodItems, setFoodItems] = useState<FoodItem[]>([\n    { name: \"\", quantity: \"\" },\n  ]);\n\n  // --------------------------\n  // ADMIN CHECK\n  // --------------------------\n  useEffect(() => {\n    async function checkAccess() {\n      setLoading(true);\n\n      const { data: authData } = await supabase.auth.getUser();\n      const user = authData?.user;\n\n      if (!user) {\n        router.push(\"/login\");\n        return;\n      }\n\n      const { data: profile, error } = await supabase\n        .from(\"profiles\")\n        .select(\"role\")\n        .eq(\"id\", user.id)\n        .maybeSingle();\n\n      if (error) {\n        console.error(\"Profile loading error:\", error);\n        router.push(\"/login\");\n        return;\n      }\n\n      if (!profile) {\n        await supabase\n          .from(\"profiles\")\n          .insert([{ id: user.id, email: user.email, role: \"user\" }]);\n\n        router.push(\"/request_access\");\n        return;\n      }\n\n      if (profile.role !== \"admin\") {\n        router.push(\"/request_access\");\n        return;\n      }\n\n      setAuthorized(true);\n      setLoading(false);\n    }\n\n    checkAccess();\n  }, [router]);\n\n  // --------------------------\n  // FOOD ITEM HELPERS\n  // --------------------------\n  const addFoodItem = () => {\n    setFoodItems((prev) => [...prev, { name: \"\", quantity: \"\" }]);\n  };\n\n  const updateFoodItem = (\n    index: number,\n    field: \"name\" | \"quantity\",\n    value: string\n  ) => {\n    const updated = [...foodItems];\n    updated[index][field] = value;\n    setFoodItems(updated);\n  };\n\n  const removeFoodItem = (index: number) => {\n    setFoodItems(foodItems.filter((_, i) => i !== index));\n  };\n\n  // --------------------------\n  // SUBMIT EVENT\n  // --------------------------\n  const handleSubmit = async (e: any) => {\n    e.preventDefault();\n\n    const cleanFoodItems = foodItems\n      .filter((item) => item.name.trim() !== \"\" && item.quantity !== \"\")\n      .map((item) => ({\n        name: item.name.trim(),\n        quantity: Number(item.quantity),\n      }));\n\n    const { error } = await supabase.from(\"events\").insert({\n      title: eventName,\n      organizer_email: email,\n      location,\n      event_date: date,\n      event_time: time,\n      description,\n      food_items: cleanFoodItems,\n      capacity,\n      attendees: 0, // new events start with 0 attendees\n      created_at: new Date().toISOString(),\n    });\n\n    if (error) {\n      console.error(error);\n      alert(\"Failed to create event.\");\n      return;\n    }\n\n    alert(\"Event created!\");\n    router.push(\"/profile_reserve\");\n  };\n\n  // --------------------------\n  // LOADING + AUTH GUARD\n  // --------------------------\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center text-lg\">\n        Checking access...\n      </div>\n    );\n  }\n\n  if (!authorized) return null;\n\n  // --------------------------\n  // PAGE UI\n  // --------------------------\n  return (\n    <div className=\"min-h-screen flex flex-col bg-gradient-to-b from-white via-teal-50 to-teal-100\">\n      <section className=\"flex flex-col items-center justify-center flex-grow px-4\">\n        <div className=\"bg-white rounded-2xl shadow-md p-8 w-full max-w-lg\">\n          <h2 className=\"text-2xl font-semibold text-center mb-6\">\n            Create an Event\n          </h2>\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Event Name */}\n            <div>\n              <label className=\"block text-gray-700 mb-1\">Event Name</label>\n              <input\n                type=\"text\"\n                value={eventName}\n                onChange={(e) => setEventName(e.target.value)}\n                required\n                className=\"w-full border border-gray-300 rounded-lg px-4 py-2\"\n              />\n            </div>\n\n            {/* Organizer */}\n            <div>\n              <label className=\"block text-gray-700 mb-1\">Organizer Email</label>\n              <input\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                required\n                className=\"w-full border border-gray-300 rounded-lg px-4 py-2\"\n              />\n            </div>\n\n            {/* Description */}\n            <div>\n              <label className=\"block text-gray-700 mb-1\">Event Description</label>\n              <textarea\n                value={description}\n                onChange={(e) => setDescription(e.target.value)}\n                required\n                className=\"w-full border border-gray-300 rounded-lg px-4 py-2 h-24\"\n              />\n            </div>\n\n            {/* Location */}\n            <div>\n              <label className=\"block text-gray-700 mb-1\">Location</label>\n              <input\n                type=\"text\"\n                value={location}\n                onChange={(e) => setLocation(e.target.value)}\n                required\n                className=\"w-full border border-gray-300 rounded-lg px-4 py-2\"\n              />\n            </div>\n\n            {/* Date */}\n            <div>\n              <label className=\"block text-gray-700 mb-1\">Date</label>\n              <input\n                type=\"date\"\n                value={date}\n                onChange={(e) => setDate(e.target.value)}\n                required\n                className=\"w-full border border-gray-300 rounded-lg px-4 py-2\"\n              />\n            </div>\n\n            {/* Time */}\n            <div>\n              <label className=\"block text-gray-700 mb-1\">Time</label>\n              <input\n                type=\"time\"\n                value={time}\n                onChange={(e) => setTime(e.target.value)}\n                required\n                className=\"w-full border border-gray-300 rounded-lg px-4 py-2\"\n              />\n            </div>\n\n            {/* Capacity */}\n            <div>\n              <label className=\"block text-gray-700 mb-1\">Capacity</label>\n              <input\n                type=\"number\"\n                min={1}\n                value={capacity}\n                onChange={(e) => setCapacity(Number(e.target.value))}\n                required\n                className=\"w-full border border-gray-300 rounded-lg px-4 py-2\"\n              />\n            </div>\n\n            {/* Food Items */}\n            <div>\n              <label className=\"block text-gray-700 mb-2\">Food Items</label>\n\n              {foodItems.map((item, index) => (\n                <div key={index} className=\"flex gap-2 mb-2 items-center\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"Food name\"\n                    value={item.name}\n                    onChange={(e) => updateFoodItem(index, \"name\", e.target.value)}\n                    required\n                    className=\"flex-1 border border-gray-300 rounded-lg px-3 py-2\"\n                  />\n\n                  <input\n                    type=\"number\"\n                    placeholder=\"Qty\"\n                    value={item.quantity}\n                    onChange={(e) => updateFoodItem(index, \"quantity\", e.target.value)}\n                    required\n                    className=\"w-24 border border-gray-300 rounded-lg px-3 py-2\"\n                  />\n\n                  {foodItems.length > 1 && (\n                    <button\n                      type=\"button\"\n                      onClick={() => removeFoodItem(index)}\n                      className=\"text-red-500 text-lg font-bold px-2\"\n                    >\n                      âœ•\n                    </button>\n                  )}\n                </div>\n              ))}\n\n              <button\n                type=\"button\"\n                onClick={addFoodItem}\n                className=\"mt-2 text-sm text-teal-600 font-semibold\"\n              >\n                + Add another food item\n              </button>\n            </div>\n\n            {/* Submit */}\n            <button\n              type=\"submit\"\n              className=\"w-full bg-teal-600 text-white py-2 rounded-lg hover:bg-teal-700\"\n            >\n              Submit\n            </button>\n          </form>\n        </div>\n      </section>\n\n      <footer className=\"bg-black text-white text-center text-sm py-6 mt-auto\">\n        <p>Boston University Center of Computing & Data Sciences:</p>\n        <p>Duan Family Spark! Initiative</p>\n        <p>buspark@bu.edu</p>\n      </footer>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}