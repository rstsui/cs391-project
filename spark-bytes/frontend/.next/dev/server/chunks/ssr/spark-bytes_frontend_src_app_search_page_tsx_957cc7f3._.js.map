{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ajoha/Downloads/cs391-project/cs391-project/spark-bytes/frontend/src/app/search/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport Link from \"next/link\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { supabase } from \"@/lib/supabaseClient\";\r\n\r\nfunction formatTime(timeString: string) {\r\n  if (!timeString) return \"\";\r\n\r\n  const [hourStr, minuteStr] = timeString.split(\":\");\r\n  let hour = parseInt(hourStr);\r\n  const minute = parseInt(minuteStr);\r\n\r\n  const ampm = hour >= 12 ? \"PM\" : \"AM\";\r\n  hour = hour % 12;\r\n  if (hour === 0) hour = 12; // convert 0 → 12 AM\r\n\r\n  return `${hour}:${minute.toString().padStart(2, \"0\")} ${ampm}`;\r\n}\r\n\r\ntype FoodItem = {\r\n  name: string;\r\n  quantity: string;\r\n};\r\n\r\ntype EventType = {\r\n  id: number;\r\n  title: string;\r\n  location: string;\r\n  event_date: string;\r\n  event_time: string;\r\n  food_items: FoodItem[];\r\n  organizer_email: string;\r\n};\r\n\r\nexport default function SearchPage() {\r\n  const [events, setEvents] = useState<EventType[]>([]);\r\n  const [filtered, setFiltered] = useState<EventType[]>([]);\r\n  const [query, setQuery] = useState(\"\");\r\n\r\n  // Load events on mount\r\n  useEffect(() => {\r\n    async function loadEvents() {\r\n      const { data, error } = await supabase\r\n        .from(\"events\")\r\n        .select(\"*\")\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n      if (error) {\r\n        console.error(error);\r\n        return;\r\n      }\r\n\r\n      setEvents(data as EventType[]);\r\n      setFiltered(data as EventType[]);\r\n    }\r\n\r\n    loadEvents();\r\n  }, []);\r\n\r\n  // Search function\r\n  const handleSearch = async () => {\r\n  const lower = query.toLowerCase();\r\n\r\n  // Fetch events matching title or location\r\n  const { data, error } = await supabase\r\n    .from(\"events\")\r\n    .select(\"*\")\r\n    .or(`title.ilike.%${query}%,location.ilike.%${query}%`)\r\n    .order(\"created_at\", { ascending: false });\r\n\r\n  if (error) {\r\n    console.error(error);\r\n    return;\r\n  }\r\n\r\n  // Filter food_items and safely check title/location\r\n  const filteredData = (data || []).filter((event: EventType) => {\r\n    const titleMatch = event.title?.toLowerCase().includes(lower);\r\n    const locationMatch = event.location?.toLowerCase().includes(lower);\r\n    const foodMatch = event.food_items?.some(item =>\r\n      item.name?.toLowerCase().includes(lower)\r\n    );\r\n\r\n    return titleMatch || locationMatch || foodMatch;\r\n  });\r\n\r\n  setFiltered(filteredData);\r\n};\r\n\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-100 via-white to-teal-100 flex flex-col\">\r\n      {/* Search Section */}\r\n      <section className=\"flex flex-col items-center justify-center flex-grow px-4\">\r\n        <h1 className=\"text-3xl font-semibold mb-6 text-center\">\r\n          Search Spark!Bytes Events\r\n        </h1>\r\n\r\n        {/* Search Bar */}\r\n        <div className=\"flex w-full max-w-md mb-6\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Search by name, location...\"\r\n            value={query}\r\n            onChange={(e) => setQuery(e.target.value)}\r\n            className=\"flex-grow border border-gray-300 rounded-l-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500\"\r\n          />\r\n          <button\r\n            onClick={handleSearch}\r\n            className=\"bg-teal-600 text-white px-4 py-2 rounded-r-lg hover:bg-teal-700\"\r\n          >\r\n            Search\r\n          </button>\r\n        </div>\r\n\r\n        {/* Events Grid */}\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 w-full max-w-4xl mt-10\">\r\n          {filtered.length === 0 && (\r\n            <p className=\"text-gray-600 text-center w-full col-span-full\">\r\n              No events found.\r\n            </p>\r\n          )}\r\n\r\n          {filtered.map((event) => (\r\n            <Link key={event.id} href={`/events/${event.id}`}>\r\n              <div className=\"bg-white shadow-md border border-gray-300 rounded-xl p-5 cursor-pointer hover:shadow-lg transition\">\r\n                {/* Title */}\r\n                <h3 className=\"text-xl font-semibold mb-2\">{event.title}</h3>\r\n\r\n                {/* Location */}\r\n                <p className=\"text-gray-700\">\r\n                  <strong>Location:</strong> {event.location}\r\n                </p>\r\n\r\n                {/* Date */}\r\n                <p className=\"text-gray-700\">\r\n                  <strong>Date:</strong> {event.event_date}\r\n                </p>\r\n\r\n                {/* Time */}\r\n                <p className=\"text-gray-700\">\r\n                  <strong>Time:</strong> {formatTime(event.event_time)}\r\n                </p>\r\n\r\n                {/* Food List */}\r\n                <p className=\"text-gray-700\">\r\n                  <strong>Food:</strong>\r\n                </p>\r\n                <ul className=\"ml-4 list-disc text-gray-700\">\r\n                  {event.food_items?.map((item, index) => (\r\n                    <li key={index}>\r\n                      {item.name} — {item.quantity} left\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              </div>\r\n            </Link>\r\n          ))}\r\n        </div>\r\n      </section>\r\n\r\n      <footer className=\"bg-black text-white text-center text-sm py-6 px-4 mt-auto\">\r\n        <p>\r\n          Boston University Center of Computing & Data Sciences: Duan Family Spark! Initiative\r\n        </p>\r\n        <p>665 Commonwealth Ave., Boston, MA 02215 | Floor 2, Spark! Space</p>\r\n        <p>buspark@bu.edu</p>\r\n      </footer>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}